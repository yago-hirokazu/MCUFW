Microsoft Windows [Version 10.0.19044.2728]
(c) Microsoft Corporation. All rights reserved.

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>setpath.bat
Press any key to continue . . .

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>make
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP test_par.c -o _output/test_par.o
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP ../../run.c -o _output/run.o
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP ../../tty.c -o _output/tty.o
../../tty.c:235:17: error: conflicting types for 'tokenize'
 struct tty_arg *tokenize(char *line, struct tty_arg *arg)
                 ^
../../tty.c:100:24: note: previous declaration of 'tokenize' was here
 extern struct tty_arg *tokenize(char *line, int (*delim)(char c), struct tty_arg *arg);
                        ^
make: *** [_output/tty.o] エラー 1

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>make
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP ../../tty.c -o _output/tty.o
../../tty.c: In function 'make_clarg':
../../tty.c:278:25: warning: passing argument 2 of 'tokenize' from incompatible pointer type [-Wincompatible-pointer-types]
  arg_p = tokenize(line, arg);
                         ^
../../tty.c:201:17: note: expected 'int (*)(char)' but argument is of type 'struct tty_arg *'
 struct tty_arg *tokenize(char *line, int (*delim)(char c), struct tty_arg *arg)
                 ^
../../tty.c:278:10: error: too few arguments to function 'tokenize'
  arg_p = tokenize(line, arg);
          ^
../../tty.c:201:17: note: declared here
 struct tty_arg *tokenize(char *line, int (*delim)(char c), struct tty_arg *arg)
                 ^
make: *** [_output/tty.o] エラー 1

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>make
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP ../../tty.c -o _output/tty.o
gcc -mno-ms-bitfields -g -O0 -I. -I../../include -I../../../elib -I../../target/windows -I../../../../target/windows/Adapt -c -MMD -MP ../../target/windows/tty_adapt.c -o _output/tty_adapt.o
g++ -o test_par.exe _output/test_par.o _output/code.o _output/echo.o _output/expr.o _output/help.o _output/par.o _output/run.o _output/slex.o _output/test.o _output/tok.o _output/tty.o _output/stdio_adapt.o _output/tty_adapt.o _output/sample.o _output/qbyte.o _output/symchar.o -lwinmm

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>test_par.exe test1.sh
Lexically analyzing characters to make tokens
---------------------------------------------
#scan(#, &aline)=0x0000
!scan(!, &aline)=0x0000
/scan(/, &aline)=0x0000
bscan(b, &aline)=0x0000
iscan(i, &aline)=0x0000
nscan(n, &aline)=0x0000
/scan(/, &aline)=0x0000
sscan(s, &aline)=0x0000
hscan(h, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 11
Raw    : #!/bin/sh
BEFORE delimit: #!/bin/sh
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: #!/bin/sh
[tty.c|count_arg()|L409] *cp=23
[tty.c|delim_nul()|L671] c='#'(23)
[tty.c|delim_nul()|L671] c='#'(23)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=#
[tty.c|delim_nul()|L671] c='!'(21)
[tty.c|find_keyc()|L391] cp=0x0040C081 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=!
[tty.c|delim_nul()|L671] c='/'(2F)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=/
[tty.c|delim_nul()|L671] c='b'(62)
[tty.c|find_keyc()|L391] cp=0x0040C083 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=b
[tty.c|delim_nul()|L671] c='i'(69)
[tty.c|find_keyc()|L391] cp=0x0040C084 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=i
[tty.c|delim_nul()|L671] c='n'(6E)
[tty.c|find_keyc()|L391] cp=0x0040C085 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=n
[tty.c|delim_nul()|L671] c='/'(2F)
[tty.c|find_keyc()|L391] cp=0x0040C086 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=/
[tty.c|delim_nul()|L671] c='s'(73)
[tty.c|find_keyc()|L391] cp=0x0040C087 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=s
[tty.c|delim_nul()|L671] c='h'(68)
[tty.c|find_keyc()|L391] cp=0x0040C088 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=h
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C08A endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=#!/bin/sh
[tty.c|tokenize()|L225] argv[1]=

 1 = slex_make_token(#!/bin/sh, &token)
token[00].t_type  =T_COMMENT
token[00].t_symbol=
 1 = slex_make_token(
, &token)
token[01].t_type  =T_EOL
token[01].t_symbol=
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 1
Raw    :
BEFORE delimit:
AFTER  delimit:
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=

 1 = slex_make_token(
, &token)
token[02].t_type  =T_EOL
token[02].t_symbol=
kscan(k, &aline)=0x0000
=scan(=, &aline)=0x0000
0scan(0, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 7
Raw    : k = 0
BEFORE delimit: k = 0
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: k = 0
[tty.c|count_arg()|L409] *cp=6B
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=k
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=3D
[tty.c|delim_nul()|L671] c='='(3D)
[tty.c|delim_nul()|L671] c='='(3D)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp==
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=30
[tty.c|delim_nul()|L671] c='0'(30)
[tty.c|delim_nul()|L671] c='0'(30)
[tty.c|find_keyc()|L391] cp=0x0040C084 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=0
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C086 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=k
[tty.c|tokenize()|L225] argv[1]==
[tty.c|tokenize()|L225] argv[2]=0
[tty.c|tokenize()|L225] argv[3]=

 1 = slex_make_token(k, &token)
token[03].t_type  =T_SYMBOL
token[03].t_symbol=k
 1 = slex_make_token(=, &token)
token[04].t_type  =T_ASSIGN
token[04].t_symbol==
 1 = slex_make_token(0, &token)
token[05].t_type  =T_VALUE
token[05].t_symbol=0
 1 = slex_make_token(
, &token)
token[06].t_type  =T_EOL
token[06].t_symbol=
wscan(w, &aline)=0x0000
hscan(h, &aline)=0x0000
iscan(i, &aline)=0x0000
lscan(l, &aline)=0x0000
escan(e, &aline)=0x0000
 scan( , &aline)=0x0002
[scan([, &aline)=0x0000
 scan( , &aline)=0x0002
$scan($, &aline)=0x0000
kscan(k, &aline)=0x0000
 scan( , &aline)=0x0002
-scan(-, &aline)=0x0000
nscan(n, &aline)=0x0000
escan(e, &aline)=0x0000
 scan( , &aline)=0x0002
4scan(4, &aline)=0x0000
 scan( , &aline)=0x0002
]scan(], &aline)=0x0000
 scan( , &aline)=0x0002
;scan(;, &aline)=0x0000
 scan( , &aline)=0x0002
dscan(d, &aline)=0x0000
oscan(o, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 25
Raw    : while [ $k -ne 4 ] ; do
BEFORE delimit: while [ $k -ne 4 ] ; do
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: while [ $k -ne 4 ] ; do
[tty.c|count_arg()|L409] *cp=77
[tty.c|delim_nul()|L671] c='w'(77)
[tty.c|delim_nul()|L671] c='w'(77)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=w
[tty.c|delim_nul()|L671] c='h'(68)
[tty.c|find_keyc()|L391] cp=0x0040C081 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=h
[tty.c|delim_nul()|L671] c='i'(69)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=i
[tty.c|delim_nul()|L671] c='l'(6C)
[tty.c|find_keyc()|L391] cp=0x0040C083 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=l
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|find_keyc()|L391] cp=0x0040C084 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=e
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=5B
[tty.c|delim_nul()|L671] c='['(5B)
[tty.c|delim_nul()|L671] c='['(5B)
[tty.c|find_keyc()|L391] cp=0x0040C086 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=[
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=24
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|find_keyc()|L391] cp=0x0040C088 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=$
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|find_keyc()|L391] cp=0x0040C089 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=k
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=2D
[tty.c|delim_nul()|L671] c='-'(2D)
[tty.c|delim_nul()|L671] c='-'(2D)
[tty.c|find_keyc()|L391] cp=0x0040C08B endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=-
[tty.c|delim_nul()|L671] c='n'(6E)
[tty.c|find_keyc()|L391] cp=0x0040C08C endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=n
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|find_keyc()|L391] cp=0x0040C08D endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=e
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=34
[tty.c|delim_nul()|L671] c='4'(34)
[tty.c|delim_nul()|L671] c='4'(34)
[tty.c|find_keyc()|L391] cp=0x0040C08F endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=4
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=5D
[tty.c|delim_nul()|L671] c=']'(5D)
[tty.c|delim_nul()|L671] c=']'(5D)
[tty.c|find_keyc()|L391] cp=0x0040C091 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=]
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=3B
[tty.c|delim_nul()|L671] c=';'(3B)
[tty.c|delim_nul()|L671] c=';'(3B)
[tty.c|find_keyc()|L391] cp=0x0040C093 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=;
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=64
[tty.c|delim_nul()|L671] c='d'(64)
[tty.c|delim_nul()|L671] c='d'(64)
[tty.c|find_keyc()|L391] cp=0x0040C095 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=d
[tty.c|delim_nul()|L671] c='o'(6F)
[tty.c|find_keyc()|L391] cp=0x0040C096 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=o
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C098 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=while
[tty.c|tokenize()|L225] argv[1]=[
[tty.c|tokenize()|L225] argv[2]=$k
[tty.c|tokenize()|L225] argv[3]=-ne
[tty.c|tokenize()|L225] argv[4]=4
[tty.c|tokenize()|L225] argv[5]=]
[tty.c|tokenize()|L225] argv[6]=;
[tty.c|tokenize()|L225] argv[7]=do
[tty.c|tokenize()|L225] argv[8]=

 1 = slex_make_token(while, &token)
token[07].t_type  =T_WHILE
token[07].t_symbol=while
 0 = slex_make_token([, &token)
token[08].t_type  =T_LBRACKET
token[08].t_symbol=[
 0 = slex_make_token($k, &token)
token[09].t_type  =T_CMD_VARG
token[09].t_symbol=k
 0 = slex_make_token(-ne, &token)
token[10].t_type  =T_CMD_ARG
token[10].t_symbol=-ne
 0 = slex_make_token(4, &token)
token[11].t_type  =T_CMD_ARG
token[11].t_symbol=4
 0 = slex_make_token(], &token)
token[12].t_type  =T_RBRACKET
token[12].t_symbol=]
 1 = slex_make_token(;, &token)
token[13].t_type  =T_SEMICOLON
token[13].t_symbol=;
 1 = slex_make_token(do, &token)
token[14].t_type  =T_DO
token[14].t_symbol=do
 1 = slex_make_token(
, &token)
token[15].t_type  =T_EOL
token[15].t_symbol=
scan( , &aline)=0x0000
scan( , &aline)=0x0000
scan( , &aline)=0x0000
scan( , &aline)=0x0000
escan(e, &aline)=0x0000
cscan(c, &aline)=0x0000
hscan(h, &aline)=0x0000
oscan(o, &aline)=0x0000
 scan( , &aline)=0x0002
$scan($, &aline)=0x0000
kscan(k, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 9
Raw    : echo $k
BEFORE delimit: echo $k
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: echo $k
[tty.c|count_arg()|L409] *cp=65
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=e
[tty.c|delim_nul()|L671] c='c'(63)
[tty.c|find_keyc()|L391] cp=0x0040C081 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=c
[tty.c|delim_nul()|L671] c='h'(68)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=h
[tty.c|delim_nul()|L671] c='o'(6F)
[tty.c|find_keyc()|L391] cp=0x0040C083 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=o
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=24
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|find_keyc()|L391] cp=0x0040C085 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=$
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|find_keyc()|L391] cp=0x0040C086 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=k
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C088 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=echo
[tty.c|tokenize()|L225] argv[1]=$k
[tty.c|tokenize()|L225] argv[2]=

 0 = slex_make_token(echo, &token)
token[16].t_type  =T_BLTN_CMD
token[16].t_symbol=echo
 0 = slex_make_token($k, &token)
token[17].t_type  =T_CMD_VARG
token[17].t_symbol=k
 1 = slex_make_token(
, &token)
token[18].t_type  =T_EOL
token[18].t_symbol=
scan( , &aline)=0x0000
scan( , &aline)=0x0000
scan( , &aline)=0x0000
scan( , &aline)=0x0000
kscan(k, &aline)=0x0000
=scan(=, &aline)=0x0000
`scan(`, &aline)=0x0000
escan(e, &aline)=0x0000
xscan(x, &aline)=0x0000
pscan(p, &aline)=0x0000
rscan(r, &aline)=0x0000
 scan( , &aline)=0x0002
$scan($, &aline)=0x0000
kscan(k, &aline)=0x0000
 scan( , &aline)=0x0002
+scan(+, &aline)=0x0000
 scan( , &aline)=0x0002
1scan(1, &aline)=0x0000
`scan(`, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 21
Raw    : k = ` expr $k + 1 `
BEFORE delimit: k = ` expr $k + 1 `
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: k = ` expr $k + 1 `
[tty.c|count_arg()|L409] *cp=6B
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=k
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=3D
[tty.c|delim_nul()|L671] c='='(3D)
[tty.c|delim_nul()|L671] c='='(3D)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp==
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=60
[tty.c|delim_nul()|L671] c='`'(60)
[tty.c|delim_nul()|L671] c='`'(60)
[tty.c|find_keyc()|L391] cp=0x0040C084 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=`
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=65
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|find_keyc()|L391] cp=0x0040C086 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=e
[tty.c|delim_nul()|L671] c='x'(78)
[tty.c|find_keyc()|L391] cp=0x0040C087 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=x
[tty.c|delim_nul()|L671] c='p'(70)
[tty.c|find_keyc()|L391] cp=0x0040C088 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=p
[tty.c|delim_nul()|L671] c='r'(72)
[tty.c|find_keyc()|L391] cp=0x0040C089 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=r
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=24
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|delim_nul()|L671] c='$'(24)
[tty.c|find_keyc()|L391] cp=0x0040C08B endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=$
[tty.c|delim_nul()|L671] c='k'(6B)
[tty.c|find_keyc()|L391] cp=0x0040C08C endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=k
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=2B
[tty.c|delim_nul()|L671] c='+'(2B)
[tty.c|delim_nul()|L671] c='+'(2B)
[tty.c|find_keyc()|L391] cp=0x0040C08E endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=+
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=31
[tty.c|delim_nul()|L671] c='1'(31)
[tty.c|delim_nul()|L671] c='1'(31)
[tty.c|find_keyc()|L391] cp=0x0040C090 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=1
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=60
[tty.c|delim_nul()|L671] c='`'(60)
[tty.c|delim_nul()|L671] c='`'(60)
[tty.c|find_keyc()|L391] cp=0x0040C092 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=`
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C094 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=k
[tty.c|tokenize()|L225] argv[1]==
[tty.c|tokenize()|L225] argv[2]=`
[tty.c|tokenize()|L225] argv[3]=expr
[tty.c|tokenize()|L225] argv[4]=$k
[tty.c|tokenize()|L225] argv[5]=+
[tty.c|tokenize()|L225] argv[6]=1
[tty.c|tokenize()|L225] argv[7]=`
[tty.c|tokenize()|L225] argv[8]=

 1 = slex_make_token(k, &token)
token[19].t_type  =T_SYMBOL
token[19].t_symbol=k
 1 = slex_make_token(=, &token)
token[20].t_type  =T_ASSIGN
token[20].t_symbol==
 0 = slex_make_token(`, &token)
token[21].t_type  =T_LBACKQUOTE
token[21].t_symbol=`
 0 = slex_make_token(expr, &token)
token[22].t_type  =T_BLTN_CMD
token[22].t_symbol=expr
 0 = slex_make_token($k, &token)
token[23].t_type  =T_CMD_VARG
token[23].t_symbol=k
 0 = slex_make_token(+, &token)
token[24].t_type  =T_CMD_ARG
token[24].t_symbol=+
 0 = slex_make_token(1, &token)
token[25].t_type  =T_CMD_ARG
token[25].t_symbol=1
 0 = slex_make_token(`, &token)
token[26].t_type  =T_RBACKQUOTE
token[26].t_symbol=`
 1 = slex_make_token(
, &token)
token[27].t_type  =T_EOL
token[27].t_symbol=
dscan(d, &aline)=0x0000
oscan(o, &aline)=0x0000
nscan(n, &aline)=0x0000
escan(e, &aline)=0x0000
[tty.c|scan_normal()|L341] LF=0x0A

scan(
, &aline)=0x0001
aline.wp = 6
Raw    : done
BEFORE delimit: done
[tty.c|delimit()|L687] found delimiter
AFTER  delimit: done
[tty.c|count_arg()|L409] *cp=64
[tty.c|delim_nul()|L671] c='d'(64)
[tty.c|delim_nul()|L671] c='d'(64)
[tty.c|find_keyc()|L391] cp=0x0040C080 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=d
[tty.c|delim_nul()|L671] c='o'(6F)
[tty.c|find_keyc()|L391] cp=0x0040C081 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=o
[tty.c|delim_nul()|L671] c='n'(6E)
[tty.c|find_keyc()|L391] cp=0x0040C082 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=n
[tty.c|delim_nul()|L671] c='e'(65)
[tty.c|find_keyc()|L391] cp=0x0040C083 endaddr=0x0040C0BF
[tty.c|find_keyc()|L395] *cp=e
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=0A
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|delim_nul()|L671] c='
'(0A)
[tty.c|find_keyc()|L391] cp=0x0040C085 endaddr=0x0040C0BF
[tty.c|find_keyc()|L393] *cp=0x0A
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|find_keyc()|L402] done searching
[tty.c|count_arg()|L409] *cp=00
[tty.c|delim_nul()|L671] c=' '(00)
[tty.c|delim_nul()|L673] delimiter: nul
[tty.c|tokenize()|L225] argv[0]=done
[tty.c|tokenize()|L225] argv[1]=

 1 = slex_make_token(done, &token)
token[28].t_type  =T_DONE
token[28].t_symbol=done
 1 = slex_make_token(
, &token)
token[29].t_type  =T_EOL
token[29].t_symbol=

30 tokens were made from 76 characters

Result of lexical analysis
--------------------------
token[00]: T_COMMENT,
token[01]: T_EOL,
token[02]: T_EOL,
token[03]: T_SYMBOL,    k
token[04]: T_ASSIGN,    =
token[05]: T_VALUE,     0
token[06]: T_EOL,
token[07]: T_WHILE,     while
token[08]: T_LBRACKET,  [
token[09]: T_CMD_VARG,  k
token[10]: T_CMD_ARG,   -ne
token[11]: T_CMD_ARG,   4
token[12]: T_RBRACKET,  ]
token[13]: T_SEMICOLON, ;
token[14]: T_DO,        do
token[15]: T_EOL,
token[16]: T_BLTN_CMD,  echo
token[17]: T_CMD_VARG,  k
token[18]: T_EOL,
token[19]: T_SYMBOL,    k
token[20]: T_ASSIGN,    =
token[21]: T_LBACKQUOTE,        `
token[22]: T_BLTN_CMD,  expr
token[23]: T_CMD_VARG,  k
token[24]: T_CMD_ARG,   +
token[25]: T_CMD_ARG,   1
token[26]: T_RBACKQUOTE,        `
token[27]: T_EOL,
token[28]: T_DONE,      done
token[29]: T_EOL,

Parsing tokens to make byte codes
---------------------------------
# of codes =  28
code[  0]=OP_BLTN_CMD
code[  1]=01
code[  2]=OP_CMD_VARG
code[  3]=00
code[  4]=OP_CMD_ARG
code[  5]=00
code[  6]=OP_CMD_ARG
code[  7]=01
code[  8]=OP_CMD_EXE_THEN_STACK
code[  9]=OP_JUMP_IF_FALSE
code[ 10]=01
code[ 11]=OP_BLTN_CMD
code[ 12]=03
code[ 13]=OP_CMD_VARG
code[ 14]=00
code[ 15]=OP_CMD_EXE
code[ 16]=OP_BLTN_CMD
code[ 17]=02
code[ 18]=OP_CMD_VARG
code[ 19]=00
code[ 20]=OP_CMD_ARG
code[ 21]=02
code[ 22]=OP_CMD_ARG
code[ 23]=03
code[ 24]=OP_CMD_EXE_THEN_ASSIGN
code[ 25]=00
code[ 26]=OP_JUMP
code[ 27]=00
code[ 28]=OP_NOP
Variable:
v_var[0]: k = 0
Label:
l_addr[0] =   0
l_addr[1] =  28
String:
s_str[0] = -ne
s_str[1] = 4
s_str[2] = +
s_str[3] = 1

C:\Users\yagouhir\usr\code\MCUFW\core\esh\test\par>